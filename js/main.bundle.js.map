{"version":3,"file":"main.bundle.js","mappings":"mBAIqB,IAACA,EAAKC,IAYX,IAZMD,EAYT,GAXD,GAAKC,EAAM,IAIjBA,EAAMD,KACPA,EAAKC,GAAO,CAACA,EAAKD,IAGdE,KAAKC,MAAMD,KAAKE,UAAYH,EAAMD,EAAM,KAQrB,EAACK,EAAMC,EAAIC,KAKrC,MAAMC,EAAcC,EAAEL,OAMJ,IAAK,KANgB,GACjCM,EAAaR,KAAKS,IAAI,GAKA,IAHrBT,KAAKU,MAAMJ,EAAcE,EAAwB,EAG1DG,GAGA,MAUMC,EAAYC,GAJX,QAKEA,EAAIC,KAJH,WAIuBD,EAAIC,IC5C/BC,EAAgBC,SAASC,cAAc,UAAUC,QACjDC,EAAgBH,SAASI,yBACzBC,EAAkBL,SAASC,cAAc,YAAYC,QACrDI,EAAkBN,SAASI,yBAE3BG,EAAgB,KACpB,MAAMC,EAAaR,SAASC,cAAc,UACpCQ,EAAeT,SAASC,cAAc,YAExCO,GACFA,EAAWE,SAGTD,GACFA,EAAaC,QACf,EAsDFV,SAASW,iBAAiB,SAAS,KACjCJ,GAAe,ICxEjB,MCWMK,EAAiBZ,SAASC,cAAc,UAE9CW,EAAeD,iBAAiB,SAAS,KACvC,MAAME,EAAcD,EAAeE,MAAMC,OAErCF,EARmB,GASrBD,EAAeI,kBAAkB,gBATZ,GASiDH,GAAe,UAC5EA,EATY,IAUrBD,EAAeI,kBAAkB,mBAAqBH,EAVjC,KAUmE,UAExFD,EAAeI,kBAAkB,IAGnCJ,EAAeK,gBAAgB,IAKjC,MAAMC,EAAalB,SAASC,cAAc,SACpCkB,EAAanB,SAASC,cAAc,UAEpCmB,EAAmB,KAGvB,OAFuBF,EAAWJ,OAGhC,IAAK,WACHK,EAAWrC,IAAM,EACjBqC,EAAWE,YAAc,IACzB,MACF,IAAK,OACHF,EAAWrC,IAAM,IACjBqC,EAAWE,YAAc,OACzB,MACF,IAAK,QACHF,EAAWrC,IAAM,IACjBqC,EAAWE,YAAc,OACzB,MACF,IAAK,SACHF,EAAWrC,IAAM,IACjBqC,EAAWE,YAAc,QAI7B,EAGFH,EAAWP,iBAAiB,SAAUS,GAEtC,MAAME,EAAkB,IAElBC,EAAiBvB,SAASC,cAAc,UAE9CsB,EAAeZ,iBAAiB,SAAS,KACpBa,SAASD,EAAeT,OAE1BQ,EACfC,EAAeP,kBAAkB,qBAAuBM,GAExDC,EAAeP,kBAAkB,IAGnCO,EAAeN,gBAAgB,IAGjCG,IAI8B,EAACK,EAAgBC,KAC7C,MAAMC,EAAe3B,SAAS4B,eAkBV,UAjBdC,EAAgB7B,SAAS4B,eAiBD,WAPxBE,EAA2BvC,EAAEwC,MARP,WAC1BF,EAAcf,MAAQkB,KAAKlB,KAC7B,GAM6Da,GACvDM,EAA4B1C,EAAEwC,MALP,WAC3BJ,EAAab,MAAQkB,KAAKlB,KAC5B,GAG+De,GAE/DF,EAAahB,iBAAiB,SAAUmB,GACxCD,EAAclB,iBAAiB,SAAUsB,EAA0B,EAGrEC,GAIkC,MAChC,MAAMC,EAAmBnC,SAAS4B,eAAe,eAC3CQ,EAAiBpC,SAAS4B,eAAe,YAE/C,SAASS,EAAmBC,GAE1BF,EAAeG,iBAAiB,UAAUC,SAASC,IACjDA,EAAOC,UAAW,CAAK,IAIE,IAAvBJ,GACFF,EAAetB,MAAQ,IACvB6B,EAAeP,EAAgB,CAAC,IAAK,IAAK,OACV,IAAvBE,EACTK,EAAeP,EAAgB,CAAC,IAAK,MACL,IAAvBE,EACTK,EAAeP,EAAgB,CAAC,MACA,MAAvBE,IACTF,EAAetB,MAAQ,IACvB6B,EAAeP,EAAgB,CAAC,IAAK,IAAK,MAE9C,CAGA,SAASO,EAAeC,EAAeC,GACrCD,EAAcL,iBAAiB,UAAUC,SAASC,IAC5CI,EAAOC,SAASL,EAAO3B,SACzB2B,EAAOC,UAAW,EACpB,GAEJ,CAGAP,EAAiBxB,iBAAiB,UAAU,KAE1C0B,EAD2Bb,SAASW,EAAiBrB,OACf,IAKxCuB,EAD0Bb,SAASW,EAAiBrB,OACf,EAGvCiC,GAIA,MAAMC,EAAa,CAAC,MAAO,OAAQ,OAE7BC,EAAcjD,SAASC,cAAc,WACrCiD,EAAmBlD,SAASC,cAAc,4BAC1CkD,EAAUD,EAAiBjD,cAAc,OAE/CgD,EAAYtC,iBAAiB,UAAU,KACrC,MAAMyC,EAAOH,EAAYI,MAAM,GACzBC,EAAWF,EAAKG,KAAKC,cAM3B,GAJgBR,EAAWS,MAAMC,GACxBJ,EAASK,SAASD,KAGd,CACX,MAAME,EAAS,IAAIC,WAEnBD,EAAOjD,iBAAiB,QAAQ,KAC9BwC,EAAQW,IAAMF,EAAOG,OAErBZ,EAAQa,gBAAgB,SACxBb,EAAQa,gBAAgB,UAExBd,EAAiBe,MAAMC,QAAU,MACjChB,EAAiBe,MAAME,QAAU,OACjCjB,EAAiBe,MAAMG,WAAa,IACpClB,EAAiBe,MAAMI,eAAiB,SACxCnB,EAAiBe,MAAMK,WAAa,SACpCpB,EAAiBe,MAAMM,SAAW,SAElCpB,EAAQc,MAAMO,UAAY,MAAM,IAGlCZ,EAAOa,cAAcrB,EACvB,KAKF,MAAMsB,EAAoB1E,SAASC,cAAc,WAC3C0E,EAAyB3E,SAASC,cAAc,mBAEtDyE,EAAkB/D,iBAAiB,UAAU,KAC3C,MAAMyC,EAAOsB,EAAkBrB,MAAM,GAC/BO,EAAS,IAAIC,WAEH,CAAC,YAAa,aAAc,aAAaJ,MAAMmB,GAASxB,EAAKwB,OAASA,MAGpFhB,EAAOjD,iBAAiB,QAAQ,KAC9B,MAAMkE,EAAQ,IAAIC,MAClBD,EAAMf,IAAMF,EAAOG,OAEnBc,EAAMlE,iBAAiB,QAAQ,KAC7B,MAAMoE,EAAWJ,EAAuBK,YAClCR,EAAYG,EAAuBM,aAEzC,IAAIC,EAAQL,EAAMK,MACdC,EAASN,EAAMM,OAEnB,GAAID,EAAQH,EAAU,CACpB,MAAMK,EAAQL,EAAWG,EACzBA,EAAQH,EACRI,GAAkBC,CACpB,CAEA,GAAID,EAASX,EAAW,CACtB,MAAMY,EAAQZ,EAAYW,EAC1BA,EAASX,EACTU,GAAgBE,CAClB,CAEAT,EAAuBV,MAAMoB,gBAAkB,OAAOzB,EAAOG,UAC7DY,EAAuBV,MAAMqB,eAAiB,GAAGJ,OAAWC,MAC5DR,EAAuBV,MAAMsB,iBAAmB,YAChDZ,EAAuBV,MAAMuB,mBAAqB,SAClDb,EAAuBV,MAAMC,QAAU,MACvCS,EAAuBV,MAAME,QAAU,OACvCQ,EAAuBV,MAAMI,eAAiB,SAC9CM,EAAuBV,MAAMK,WAAa,SAC1CK,EAAuBV,MAAMM,SAAW,QAAQ,GAChD,IAGJX,EAAOa,cAAcrB,GACvB,IAQF,MAAMqC,EAASzF,SAASC,cAAc,YAChCyF,EAAeD,EAAOlD,iBAAiB,mCAEvCoD,EAAiB3F,SAASC,cAAc,iBACxC2F,EAAqBD,EAAepD,iBAAiB,mCAcrDsD,EAAc,KAClBJ,EAAOK,UAAUC,IAAI,qBACrBL,EAAalD,SAASwD,IACpBA,EAAQtD,UAAW,CAAI,IAGzBiD,EAAeG,UAAUC,IAAI,0BAC7BH,EAAmBpD,SAASwD,IAC1BA,EAAQtD,UAAW,CAAI,GACvB,EAGJmD,IAIA,MAAM,EAAO7F,SAASC,cAAc,YAqBhBD,SAASC,cAAc,mBAE/BU,iBAAiB,SAAS,KACpC8E,EAAOQ,QAEPC,GAAoB,IC/StB,MAAMC,EAAenG,SAASC,cAAc,SAASC,QAAQD,cAAc,UAErEmG,EAAa,CACjBC,KAAM,WACNC,SAAU,UACVC,MAAO,MACPC,OAAQ,UCAV,IAAIC,EACAC,EACAC,EAEJ,MAAMC,EAAe5G,SAASC,cAAc,YAEtC4G,EAAiBC,IACrBJ,EAAOI,EAEP,IACEH,EAAMI,EAAEJ,IAAI,cAAcK,QAAQ,CAAEC,IAAK,QAAUC,IAAK,WAAa,GAErEH,EAAEI,UACA,qDACA,CACEC,YAAa,4FAEfC,MAAMV,GAER,MAAMW,EAAcP,EAAEQ,KAAK,CACzBC,QAAS,mBACTC,SAAU,CAAC,GAAI,IACfC,WAAY,CAAC,GAAI,MAGbC,EAAgB,CAAEV,IAAK,QAAUC,IAAK,WAE5CT,EAAgBM,EAAEa,OAAOD,EAAe,CACtCE,WAAW,EACXN,KAAMD,IAGRb,EAAcY,MAAMV,GAEpB,MAAMmB,EAAgBrB,EAAcsB,YAC9BC,EAAyBC,EAAkBH,EAAcb,IAAKa,EAAcZ,KAClFN,EAAa9F,MAAQkH,EAErBvB,EAAcyB,GAAG,aAAcrI,IAC7B,MAAMsI,EAAStI,EAAIuI,OAAOL,YACpBM,EAAkBJ,EAAkBE,EAAOlB,IAAKkB,EAAOjB,KAC7DN,EAAa9F,MAAQuH,CAAe,IAGtC,MAAMC,EAAoBtI,SAASC,cAAc,iBAC3CsI,EAAqBvI,SAASC,cAAc,kBAC5CuI,EAAqBxI,SAASC,cAAc,kBAC5CwI,EAAsBzI,SAASC,cAAc,mBAC7CyI,EAA0B1I,SAASC,cAAc,qBAEjD0I,EAAgB,KACpB,MAAMC,EAAeN,EAAkBxH,MACjC+H,EAAgBN,EAAmBzH,MACnCgI,EAAgBN,EAAmB1H,MACnCiI,EAAiBN,EAAoB3H,MACrCkI,EAAmBC,MAAM9J,KAAKuJ,EAAwBnG,iBAAiB,kBAC1EoE,KAAKuC,GAAUA,EAAMpI,QAExB,IAAIqI,EChEkB,EAACrC,EAASlC,IAC7BkC,EAAQsC,QAAQxB,IACrB,MAAMyB,EAAYzB,EAAO0B,MAAM1E,KAC/B,MAAgB,QAATA,GAAkByE,IAAczE,CAAI,ID6DnB2E,CAAoB7C,EAAMkC,GAChDO,EC1DuB,EAACrC,EAAS0C,IAC9B1C,EAAQsC,QAAQxB,IACrB,MAAM6B,EAAa7B,EAAO0B,MAAME,MAChC,OAAQA,GACN,IAAK,MACH,OAAOC,EAAa,IACtB,IAAK,SACH,OAAOA,GAAc,KAASA,GAAc,IAC9C,IAAK,OACH,OAAOA,EAAa,IACtB,QACE,OAAO,EACX,ID8CoBC,CAAqBP,EAAiBN,GACxDM,EC3CuB,EAACrC,EAASgC,IACf,QAAlBA,EACKhC,EAEFA,EAAQsC,QAAQxB,GAAWA,EAAO0B,MAAMK,QAAUnI,SAASsH,EAAe,MDuC3Dc,CAAqBT,EAAiBL,GACxDK,ECrCwB,EAACrC,EAASiC,IACf,QAAnBA,EACKjC,EAEFA,EAAQsC,QAAQxB,GAAWA,EAAO0B,MAAMO,SAAWrI,SAASuH,EAAgB,MDiC7De,CAAsBX,EAAiBJ,GACzDI,EC/B0B,EAACrC,EAASkC,IACjClC,EAAQsC,QAAQxB,GAEdoB,EAAiBe,OAAOC,GAAYpC,EAAO0B,MAAMW,SAASnH,SAASkH,OD4BtDE,CAAwBf,EAAiBH,GAE3DmB,EAAchB,EAAgB,EAGhCb,EAAkB3H,iBAAiB,SAAUgI,GAC7CJ,EAAmB5H,iBAAiB,SAAUgI,GAC9CH,EAAmB7H,iBAAiB,SAAUgI,GAC9CF,EAAoB9H,iBAAiB,SAAUgI,GAC/CD,EAAwB/H,iBAAiB,SAAUgI,GAEnDA,IF2KFlD,EAAOK,UAAUpF,OAAO,qBACxBgF,EAAalD,SAASwD,IACpBA,EAAQhC,gBAAgB,WAAW,IAGrC2B,EAAeG,UAAUpF,OAAO,0BAChCkF,EAAmBpD,SAASwD,IAC1BA,EAAQhC,gBAAgB,WAAW,GE/KrC,CAAE,MAAOoG,GAEP,MADAvE,IACM,IAAIwE,MAAM,oCAClB,GAGInE,EAAqB,KACzB,GAAIO,EAAe,CACjB,MAAMqB,EAAgB,CAAEb,IAAK,QAAUC,IAAK,WAC5CT,EAAc6D,UAAUxC,EAC1B,GAGIG,EAAoB,CAAChB,EAAKC,IAGvB,GAFYD,EAAIsD,QAAQ,OACZrD,EAAIqD,QAAQ,KAI3BJ,EAAiBrD,IACrBH,EAAI6D,WAAWC,IACTA,aAAiB1D,EAAE2D,QACrB/D,EAAIgE,YAAYF,EAClB,IAGF,MAAMnD,EAAcP,EAAEQ,KAAK,CACzBC,QAAS,mBACTC,SAAU,CAAC,GAAI,IACfC,WAAY,CAAC,GAAI,MAKnBjB,EAAgBM,EAAEa,OAFI,CAAEX,IAAK,QAAUC,IAAK,WAEJ,CACtCW,WAAW,EACXN,KAAMD,IAGRb,EAAcY,MAAMV,GAEpBF,EAAcyB,GAAG,aAAcrI,IAC7B,MAAMsI,EAAStI,EAAIuI,OAAOL,YACpBM,EAAkBJ,EAAkBE,EAAOlB,IAAKkB,EAAOjB,KAC7DN,EAAa9F,MAAQuH,CAAe,IAGfvB,EAAQ8D,MAAM,EAAG,IAEzBpI,SAASqI,IACtB,MAAM,IAAE5D,EAAG,IAAEC,GAAQ2D,EAAMC,SAErBvD,EAAOR,EAAEQ,KAAK,CAClBC,QAAS,cACTC,SAAU,CAAC,GAAI,IACfC,WAAY,CAAC,GAAI,MAGJX,EAAEa,OACf,CACEX,MACAC,OAEF,CACEK,SAIGF,MAAMV,GAAKoE,UDpHH,GAAGzB,QAAO0B,SAAQF,eACnC,MAAMG,EAAc9E,EAAa+E,WAAU,GAE3CD,EAAYhL,cAAc,iBAAiBkL,YAAc7B,EAAM8B,MAC/DH,EAAYhL,cAAc,yBAAyBkL,YAAc,GAAGL,EAAS7D,QAAQ6D,EAAS5D,MAC9F+D,EAAYhL,cAAc,uBAAuBkL,YAAc7B,EAAME,MAAQ,UAC7E,MAAM6B,EAAYjF,EAAWkD,EAAM1E,MACnCqG,EAAYhL,cAAc,gBAAgBkL,YAAcE,EACxDJ,EAAYhL,cAAc,0BAA0BkL,YAAc7B,EAAMK,MAAQ,gBAAkBL,EAAMO,OAAS,UACjHoB,EAAYhL,cAAc,sBAAsBkL,YAAc,eAAiB7B,EAAMgC,QAAU,cAAgBhC,EAAMiC,SACrH,MAAMC,EAAeP,EAAYhL,cAAc,oBAnCvB,IAACgK,EAAUwB,EAAVxB,EAoCPX,EAAMW,UApCWwB,EAoCDD,GAnCpBE,UAAY,GAE1BzB,EAASzH,SAAQwH,IACf,MAAM2B,EAAc3L,SAAS4L,cAAc,MAC3CD,EAAY7F,UAAUC,IAAI,kBAC1B4F,EAAY7F,UAAUC,IAAI,mBAAqBiE,GAC/CyB,EAAcI,YAAYF,EAAY,IA8BxCV,EAAYhL,cAAc,uBAAuBkL,YAAc7B,EAAMwC,YACrE,MAAMC,EAAad,EAAYhL,cAAc,kBA3BtB,IAAC+L,EAAQC,EA+BhC,OA/BwBD,EA4BP1C,EAAM0C,QA5BSC,EA4BDF,GA3BrBL,UAAY,GAEtBM,EAAOxJ,SAAQ0J,IACb,MAAMC,EAAenM,SAAS4L,cAAc,OAC5CO,EAAarG,UAAUC,IAAI,gBAC3BoG,EAAarI,IAAMoI,EACnBC,EAAajH,MAAQ,KACrBiH,EAAahH,OAAS,KACtBgH,EAAaC,IAAM,mBACnBH,EAAUJ,YAAYM,EAAa,IAmBrClB,EAAYhL,cAAc,kBAAkB6D,IAAMkH,EAAOqB,OAElDpB,CAAW,ECmGYqB,CAAWzB,GAAQ,CAC7C0B,YAAY,GACZ,GACF,EHxJFC,MAAM,yDACHC,MAAMC,GAAaA,EAASC,SAC5BF,MAAM/F,IKCH,CAACA,IACPG,EAAcH,EAAK,ELDfkG,CAAYlG,EAAK,ICoRrB,EAAK/F,iBAAiB,UAAWd,IDhRlB,IAAcgN,EAAWC,ECiRtCjN,EAAIkN,iBDjRuBF,ECwRzB,IF5QY,MAChB,MAAMG,EAAejN,EAAcmL,WAAU,GAE7C8B,EAAa/M,cAAc,mBAAmByL,UAAY,kCAE1D,MAAMuB,EAAcD,EAAa/M,cAAc,kBAC/CgN,EAAY9B,YAAc,oBAE1B6B,EAAa/M,cAAc,UAAUU,iBAAiB,SAAUd,IAC9CA,EAAIuI,OACRtC,UAAUoH,SAAS,UAC7B3M,GACF,IAGF0M,EAAYtM,iBAAiB,SAAS,KACpCJ,GAAe,IAGjBP,SAASW,iBAAiB,WAAYd,IAChCD,EAASC,IACXU,GACF,IAGFJ,EAAc0L,YAAYmB,GAC1BhN,SAAS8M,KAAKjB,YAAY1L,EAAc,EEkP9B0M,GDxR8BC,ECyRpC,IAAIK,SAAStN,EAAIuI,QDvRrBoE,MACE,mDACA,CACEY,OAAQ,OACRN,SAGDL,MAAMC,IACDA,EAASW,ID+BC,MAClB,MAAMC,EAAiBjN,EAAgB6K,WAAU,GAEjDoC,EAAerN,cAAc,qBAAqByL,UAAY,wCAE9D4B,EAAerN,cAAc,YAAYU,iBAAiB,SAAUd,IAClDA,EAAIuI,OACRtC,UAAUoH,SAAS,YAC7B3M,GACF,IAGFP,SAASW,iBAAiB,WAAYd,IAChCD,EAASC,IACXU,GACF,IAGFD,EAAgBuL,YAAYyB,GAC5BtN,SAAS8M,KAAKjB,YAAYvL,EAAgB,EEyNpCsM,GACA1G,KDzQA2G,GACF,IAEDU,OAAM,KACLV,GAAW,IC2Qb,EAAK5G,OAAO,G","sources":["webpack://keksobooking/./source/js/util.js","webpack://keksobooking/./source/js/alerts.js","webpack://keksobooking/./source/js/fetch.js","webpack://keksobooking/./source/js/form.js","webpack://keksobooking/./source/js/popup.js","webpack://keksobooking/./source/js/map.js","webpack://keksobooking/./source/js/filter.js","webpack://keksobooking/./source/js/main.js"],"sourcesContent":["/* global _:readonly */\n\n//Случайное число\n\nconst getRandomInt = (min, max) => {\n  if (min < 0 || max < 0) {\n    return -1;\n  }\n\n  if (max < min) {\n    [min, max] = [max, min];\n  }\n\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n};\n\ngetRandomInt(1, 10);\n\n\n// Генерация врменных координат\n\nconst generateRandomFloat = (from, to, decimalPlaces) => {\n  if (to <= from) {\n    throw new Error('Invalid range');\n  }\n\n  const randomFloat = _.random(from, to, true);\n  const multiplier = Math.pow(10, decimalPlaces);\n\n  return Math.round(randomFloat * multiplier) / multiplier;\n};\n\ngenerateRandomFloat(1.1, 1.2, 10);\n\n// Случайный элемент массива\nconst getRandomElementArr = (array) => {\n  return array[getRandomInt(0, array.length - 1)];\n};\n\n// ESCAPE\nconst Keys = {\n  ESC: 'Esc',\n  ESCAPE: 'Escape',\n};\n\nconst checkEsc = (evt) => {\n  return evt.key === Keys.ESC || evt.key === Keys.ESCAPE;\n};\n\nexport { getRandomInt, generateRandomFloat, getRandomElementArr, checkEsc };\n","import { checkEsc } from './util.js';\n\nconst errorTemplate = document.querySelector('#error').content;\nconst errorFragment = document.createDocumentFragment();\nconst successTemplate = document.querySelector('#success').content;\nconst successFragment = document.createDocumentFragment();\n\nconst removeAllerts = () => {\n  const errorAlert = document.querySelector('.error');\n  const successAlert = document.querySelector('.success');\n\n  if (errorAlert) {\n    errorAlert.remove();\n  }\n\n  if (successAlert) {\n    successAlert.remove();\n  }\n};\n\nconst showError = () => {\n  const errorElement = errorTemplate.cloneNode(true);\n\n  errorElement.querySelector('.error__message').innerHTML = 'Ошибка размещения<br>объявления';\n\n  const errorButton = errorElement.querySelector('.error__button');\n  errorButton.textContent = 'Попробовать снова';\n\n  errorElement.querySelector('.error').addEventListener('click', (evt) => {\n    const element = evt.target;\n    if (element.classList.contains('error')) {\n      removeAllerts();\n    }\n  });\n\n  errorButton.addEventListener('click', () => {\n    removeAllerts();\n  });\n\n  document.addEventListener('keydown', (evt) => {\n    if (checkEsc(evt)) {\n      removeAllerts();\n    }\n  });\n\n  errorFragment.appendChild(errorElement);\n  document.body.appendChild(errorFragment);\n};\n\nconst showSuccess = () => {\n  const successElement = successTemplate.cloneNode(true);\n\n  successElement.querySelector('.success__message').innerHTML = 'Ваше объявление<br>успешно размещено!';\n\n  successElement.querySelector('.success').addEventListener('click', (evt) => {\n    const element = evt.target;\n    if (element.classList.contains('success')) {\n      removeAllerts();\n    }\n  });\n\n  document.addEventListener('keydown', (evt) => {\n    if (checkEsc(evt)) {\n      removeAllerts();\n    }\n  });\n\n  successFragment.appendChild(successElement);\n  document.body.appendChild(successFragment);\n};\n\ndocument.addEventListener('click', () => {\n  removeAllerts();\n});\n\nexport { showError, showSuccess };\n","const getData = (showSuccess) => {\n  fetch('https://22.javascript.pages.academy/keksobooking/data')\n    .then((response) => response.json())\n    .then((data) => {\n      showSuccess(data);\n    });\n};\n\nconst sendData = (showSuccess, showError, body) => {\n\n  fetch(\n    'https://22.javascript.pages.academy/keksobooking',\n    {\n      method: 'POST',\n      body,\n    },\n  )\n    .then((response) => {\n      if (response.ok) {\n        showSuccess();\n      } else {\n        showError();\n      }\n    })\n    .catch(() => {\n      showError();\n    });\n};\n\nexport {getData, sendData};\n","/* global _:readonly */\n\nimport { showError, showSuccess } from './alerts.js';\nimport { sendData } from './fetch.js';\nimport { resetMainPinMarker } from './map.js';\n\n// Заголовок обяъвления\n\nconst MIN_TITLE_LENGTH = 30;\nconst MAX_TITLE_LENGTH = 100;\n\nconst userTitleInput = document.querySelector('#title');\n\nuserTitleInput.addEventListener('input', () => {\n  const valueLength = userTitleInput.value.length;\n\n  if (valueLength < MIN_TITLE_LENGTH) {\n    userTitleInput.setCustomValidity('Введите ещё ' + (MIN_TITLE_LENGTH - valueLength) + ' симв.');\n  } else if (valueLength > MAX_TITLE_LENGTH) {\n    userTitleInput.setCustomValidity('Удалите лишние ' + (valueLength - MAX_TITLE_LENGTH) + ' симв.');\n  } else {\n    userTitleInput.setCustomValidity('');\n  }\n\n  userTitleInput.reportValidity();\n});\n\n// Функция для обработки изменений в поле \"Тип жилья\"\n\nconst typeSelect = document.querySelector('#type');\nconst priceInput = document.querySelector('#price');\n\nconst handleTypeChange = () => {\n  const selectedOption = typeSelect.value;\n\n  switch (selectedOption) {\n    case 'bungalow':\n      priceInput.min = 0;\n      priceInput.placeholder = '0';\n      break;\n    case 'flat':\n      priceInput.min = 1000;\n      priceInput.placeholder = '1000';\n      break;\n    case 'house':\n      priceInput.min = 5000;\n      priceInput.placeholder = '5000';\n      break;\n    case 'palace':\n      priceInput.min = 10000;\n      priceInput.placeholder = '10000';\n      break;\n    default:\n      break;\n  }\n};\n\ntypeSelect.addEventListener('change', handleTypeChange);\n\nconst MAX_PRICE_VALUE = 1000000;\n\nconst userPriceInput = document.querySelector('#price');\n\nuserPriceInput.addEventListener('input', () => {\n  const priceValue = parseInt(userPriceInput.value);\n\n  if (priceValue > MAX_PRICE_VALUE) {\n    userPriceInput.setCustomValidity('Максимальная цена ' + MAX_PRICE_VALUE);\n  } else {\n    userPriceInput.setCustomValidity('');\n  }\n\n  userPriceInput.reportValidity();\n});\n\nhandleTypeChange();\n\n// Функция для обработки изменений в полях \"Время заезда и выезда\"\n\nconst synchronizeTimeFields = (timeInSelectId, timeOutSelectId) => {\n  const timeInSelect = document.getElementById(timeInSelectId);\n  const timeOutSelect = document.getElementById(timeOutSelectId);\n\n  const timeInChangeHandler = function () {\n    timeOutSelect.value = this.value;\n  };\n\n  const timeOutChangeHandler = function () {\n    timeInSelect.value = this.value;\n  };\n\n  const boundTimeInChangeHandler = _.bind(timeInChangeHandler, timeInSelect);\n  const boundTimeOutChangeHandler = _.bind(timeOutChangeHandler, timeOutSelect);\n\n  timeInSelect.addEventListener('change', boundTimeInChangeHandler);\n  timeOutSelect.addEventListener('change', boundTimeOutChangeHandler);\n};\n\nsynchronizeTimeFields('timein', 'timeout');\n\n// Функция для установки ограничений выбора количества гостей\n\nconst synchronizeRoomsAndGuests = () => {\n  const roomNumberSelect = document.getElementById('room_number');\n  const capacitySelect = document.getElementById('capacity');\n\n  function setCapacityOptions(selectedRoomNumber) {\n    // Очищаем предыдущие ограничения выбора количества гостей\n    capacitySelect.querySelectorAll('option').forEach((option) => {\n      option.disabled = false;\n    });\n\n    // Устанавливаем ограничения выбора количества гостей\n    if (selectedRoomNumber === 1) {\n      capacitySelect.value = '1';\n      disableOptions(capacitySelect, ['2', '3', '0']);\n    } else if (selectedRoomNumber === 2) {\n      disableOptions(capacitySelect, ['3', '0']);\n    } else if (selectedRoomNumber === 3) {\n      disableOptions(capacitySelect, ['0']);\n    } else if (selectedRoomNumber === 100) {\n      capacitySelect.value = '0';\n      disableOptions(capacitySelect, ['1', '2', '3']);\n    }\n  }\n\n  // Функция для отключения опций выбора количества гостей\n  function disableOptions(selectElement, values) {\n    selectElement.querySelectorAll('option').forEach((option) => {\n      if (values.includes(option.value)) {\n        option.disabled = true;\n      }\n    });\n  }\n\n  // Срабатывает при изменении выбора комнат\n  roomNumberSelect.addEventListener('change', () => {\n    const selectedRoomNumber = parseInt(roomNumberSelect.value);\n    setCapacityOptions(selectedRoomNumber);\n  });\n\n  // Инициализация ограничений выбора количества гостей при загрузке страницы\n  const initialRoomNumber = parseInt(roomNumberSelect.value);\n  setCapacityOptions(initialRoomNumber);\n};\n\nsynchronizeRoomsAndGuests();\n\n// Загрузка аватара пользователя\n\nconst FILE_TYPES = ['jpg', 'jpeg', 'png'];\n\nconst fileChooser = document.querySelector('#avatar');\nconst previewContainer = document.querySelector('.ad-form-header__preview');\nconst preview = previewContainer.querySelector('img');\n\nfileChooser.addEventListener('change', () => {\n  const file = fileChooser.files[0];\n  const fileName = file.name.toLowerCase();\n\n  const matches = FILE_TYPES.some((it) => {\n    return fileName.endsWith(it);\n  });\n\n  if (matches) {\n    const reader = new FileReader();\n\n    reader.addEventListener('load', () => {\n      preview.src = reader.result;\n\n      preview.removeAttribute('width');\n      preview.removeAttribute('height');\n\n      previewContainer.style.padding = '0px';\n      previewContainer.style.display = 'flex';\n      previewContainer.style.flexShrink = '0';\n      previewContainer.style.justifyContent = 'center';\n      previewContainer.style.alignItems = 'center';\n      previewContainer.style.overflow = 'hidden';\n\n      preview.style.maxHeight = '100%';\n    });\n\n    reader.readAsDataURL(file);\n  }\n});\n\n// Загрузка фотографий пользователя\n\nconst fileChooserImages = document.querySelector('#images');\nconst previewImagesContainer = document.querySelector('.ad-form__photo');\n\nfileChooserImages.addEventListener('change', () => {\n  const file = fileChooserImages.files[0];\n  const reader = new FileReader();\n\n  const matches = ['image/png', 'image/jpeg', 'image/jpg'].some((type) => file.type === type);\n\n  if (matches) {\n    reader.addEventListener('load', () => {\n      const image = new Image();\n      image.src = reader.result;\n\n      image.addEventListener('load', () => {\n        const maxWidth = previewImagesContainer.clientWidth;\n        const maxHeight = previewImagesContainer.clientHeight;\n\n        let width = image.width;\n        let height = image.height;\n\n        if (width > maxWidth) {\n          const ratio = maxWidth / width;\n          width = maxWidth;\n          height = height * ratio;\n        }\n\n        if (height > maxHeight) {\n          const ratio = maxHeight / height;\n          height = maxHeight;\n          width = width * ratio;\n        }\n\n        previewImagesContainer.style.backgroundImage = `url(${reader.result})`;\n        previewImagesContainer.style.backgroundSize = `${width}px ${height}px`;\n        previewImagesContainer.style.backgroundRepeat = 'no-repeat';\n        previewImagesContainer.style.backgroundPosition = 'center';\n        previewImagesContainer.style.padding = '0px';\n        previewImagesContainer.style.display = 'flex';\n        previewImagesContainer.style.justifyContent = 'center';\n        previewImagesContainer.style.alignItems = 'center';\n        previewImagesContainer.style.overflow = 'hidden';\n      });\n    });\n\n    reader.readAsDataURL(file);\n  }\n});\n\n\n\n\n// Неактивное состояние форм\n\nconst adForm = document.querySelector('.ad-form');\nconst formElements = adForm.querySelectorAll('input, select, textarea, button');\n\nconst mapFiltersForm = document.querySelector('.map__filters');\nconst mapFiltersElements = mapFiltersForm.querySelectorAll('input, select, textarea, button');\n\nconst activateForm = () => {\n  adForm.classList.remove('ad-form--disabled');\n  formElements.forEach((element) => {\n    element.removeAttribute('disabled');\n  });\n\n  mapFiltersForm.classList.remove('map__filters--disabled');\n  mapFiltersElements.forEach((element) => {\n    element.removeAttribute('disabled');\n  });\n};\n\nconst disableForm = () => {\n  adForm.classList.add('ad-form--disabled');\n  formElements.forEach((element) => {\n    element.disabled = true;\n  });\n\n  mapFiltersForm.classList.add('map__filters--disabled');\n  mapFiltersElements.forEach((element) => {\n    element.disabled = true;\n  });\n};\n\ndisableForm();\n\n// Отправка формы\n\nconst form = document.querySelector('.ad-form');\n\nconst setFormSubmit = () => {\n  form.addEventListener('submit', (evt) => {\n    evt.preventDefault();\n\n    sendData(\n      () => {\n        showSuccess();\n        resetMainPinMarker();\n      },\n      () => showError(),\n      new FormData(evt.target),\n    );\n\n    form.reset();\n  });\n};\n\n// Сброс формы\n\nconst resetButton = document.querySelector('.ad-form__reset');\n\nresetButton.addEventListener('click', () => {\n  adForm.reset();\n\n  resetMainPinMarker();\n});\n\nexport { setFormSubmit, activateForm, disableForm, handleTypeChange, synchronizeTimeFields };\n","const cardTemplate = document.querySelector('#card').content.querySelector('.popup');\n\nconst typeLabels = {\n  flat: 'Квартира',\n  bungalow: 'Бунгало',\n  house: 'Дом',\n  palace: 'Дворец',\n};\n\nconst createFeatureList = (features, parentElement) => {\n  parentElement.innerHTML = '';\n\n  features.forEach(feature => {\n    const featureItem = document.createElement('li');\n    featureItem.classList.add('popup__feature');\n    featureItem.classList.add('popup__feature--' + feature);\n    parentElement.appendChild(featureItem);\n  });\n};\n\nconst createPhotosList = (photos, container) => {\n  container.innerHTML = '';\n\n  photos.forEach(photoSrc => {\n    const photoElement = document.createElement('img');\n    photoElement.classList.add('popup__photo');\n    photoElement.src = photoSrc;\n    photoElement.width = '45';\n    photoElement.height = '40';\n    photoElement.alt = 'Фотография жилья';\n    container.appendChild(photoElement);\n  });\n};\n\nconst createCard = ({ offer, author, location }) => {\n  const cardElement = cardTemplate.cloneNode(true);\n\n  cardElement.querySelector('.popup__title').textContent = offer.title;\n  cardElement.querySelector('.popup__text--address').textContent = `${location.lat}, ${location.lng}`;\n  cardElement.querySelector('.popup__text--price').textContent = offer.price + ' ₽/ночь';\n  const typeLabel = typeLabels[offer.type];\n  cardElement.querySelector('.popup__type').textContent = typeLabel;\n  cardElement.querySelector('.popup__text--capacity').textContent = offer.rooms + ' комнаты для ' + offer.guests + ' гостей';\n  cardElement.querySelector('.popup__text--time').textContent = 'Заезд после ' + offer.checkin + ', выезд до ' + offer.checkout;\n  const featuresList = cardElement.querySelector('.popup__features');\n  createFeatureList(offer.features, featuresList);\n  cardElement.querySelector('.popup__description').textContent = offer.description;\n  const photosList = cardElement.querySelector('.popup__photos');\n  createPhotosList(offer.photos, photosList);\n  cardElement.querySelector('.popup__avatar').src = author.avatar;\n\n  return cardElement;\n};\n\nexport { createCard };\n","/* global L:readonly */\n\nimport { activateForm, disableForm } from './form.js';\nimport { createCard } from './popup.js';\nimport { filterMarkersByType, filterMarkersByPrice, filterMarkersByRooms, filterMarkersByGuests, filterMarkersByFeatures } from './filter.js';\n\nlet mainPinMarker;\nlet data; // Переменная для хранения данных о маркерах\nlet map; // Переменная для хранения карты\n\nconst addressInput = document.querySelector('#address');\n\nconst initializeMap = (markers) => {\n  data = markers; // Сохранение данных о маркерах\n\n  try {\n    map = L.map('map-canvas').setView({ lat: 35.68950, lng: 139.69171 }, 9);\n\n    L.tileLayer(\n      'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n      {\n        attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n      },\n    ).addTo(map);\n\n    const mainPinIcon = L.icon({\n      iconUrl: 'img/main-pin.svg',\n      iconSize: [52, 52],\n      iconAnchor: [26, 52],\n    });\n\n    const mainPinLatLng = { lat: 35.68950, lng: 139.69171 };\n\n    mainPinMarker = L.marker(mainPinLatLng, {\n      draggable: true,\n      icon: mainPinIcon,\n    });\n\n    mainPinMarker.addTo(map);\n\n    const initialLatLng = mainPinMarker.getLatLng();\n    const formattedInitialLatLng = formatCoordinates(initialLatLng.lat, initialLatLng.lng);\n    addressInput.value = formattedInitialLatLng;\n\n    mainPinMarker.on('mousemove', (evt) => {\n      const latLng = evt.target.getLatLng();\n      const formattedLatLng = formatCoordinates(latLng.lat, latLng.lng);\n      addressInput.value = formattedLatLng;\n    });\n\n    const housingTypeSelect = document.querySelector('#housing-type');\n    const housingPriceSelect = document.querySelector('#housing-price');\n    const housingRoomsSelect = document.querySelector('#housing-rooms');\n    const housingGuestsSelect = document.querySelector('#housing-guests');\n    const housingFeaturesFieldset = document.querySelector('#housing-features');\n\n    const filterMarkers = () => {\n      const selectedType = housingTypeSelect.value;\n      const selectedPrice = housingPriceSelect.value;\n      const selectedRooms = housingRoomsSelect.value;\n      const selectedGuests = housingGuestsSelect.value;\n      const selectedFeatures = Array.from(housingFeaturesFieldset.querySelectorAll('input:checked'))\n        .map((input) => input.value);\n\n      let filteredMarkers = filterMarkersByType(data, selectedType);\n      filteredMarkers = filterMarkersByPrice(filteredMarkers, selectedPrice);\n      filteredMarkers = filterMarkersByRooms(filteredMarkers, selectedRooms);\n      filteredMarkers = filterMarkersByGuests(filteredMarkers, selectedGuests);\n      filteredMarkers = filterMarkersByFeatures(filteredMarkers, selectedFeatures);\n\n      updateMarkers(filteredMarkers);\n    };\n\n    housingTypeSelect.addEventListener('change', filterMarkers);\n    housingPriceSelect.addEventListener('change', filterMarkers);\n    housingRoomsSelect.addEventListener('change', filterMarkers);\n    housingGuestsSelect.addEventListener('change', filterMarkers);\n    housingFeaturesFieldset.addEventListener('change', filterMarkers);\n\n    filterMarkers(); // Вызов функции фильтрации при первичной инициализации\n\n    activateForm();\n  } catch (error) {\n    disableForm();\n    throw new Error('Не удалось инициализировать карту');\n  }\n};\n\nconst resetMainPinMarker = () => {\n  if (mainPinMarker) {\n    const initialLatLng = { lat: 35.68950, lng: 139.69171 };\n    mainPinMarker.setLatLng(initialLatLng);\n  }\n};\n\nconst formatCoordinates = (lat, lng) => {\n  const roundedLat = lat.toFixed(5);\n  const roundedLng = lng.toFixed(5);\n  return `${roundedLat}, ${roundedLng}`;\n};\n\nconst updateMarkers = (markers) => {\n  map.eachLayer((layer) => {\n    if (layer instanceof L.Marker) {\n      map.removeLayer(layer);\n    }\n  });\n\n  const mainPinIcon = L.icon({\n    iconUrl: 'img/main-pin.svg',\n    iconSize: [52, 52],\n    iconAnchor: [26, 52],\n  });\n\n  const mainPinLatLng = { lat: 35.68950, lng: 139.69171 };\n\n  mainPinMarker = L.marker(mainPinLatLng, {\n    draggable: true,\n    icon: mainPinIcon,\n  });\n\n  mainPinMarker.addTo(map);\n\n  mainPinMarker.on('mousemove', (evt) => {\n    const latLng = evt.target.getLatLng();\n    const formattedLatLng = formatCoordinates(latLng.lat, latLng.lng);\n    addressInput.value = formattedLatLng;\n  });\n\n  const limitedMarkers = markers.slice(0, 10);\n\n  limitedMarkers.forEach((point) => {\n    const { lat, lng } = point.location;\n\n    const icon = L.icon({\n      iconUrl: 'img/pin.svg',\n      iconSize: [40, 40],\n      iconAnchor: [20, 40],\n    });\n\n    const marker = L.marker(\n      {\n        lat,\n        lng,\n      },\n      {\n        icon,\n      },\n    );\n\n    marker.addTo(map).bindPopup(createCard(point), {\n      keepInView: true,\n    });\n  });\n};\n\nexport { initializeMap, resetMainPinMarker };\n","const filterMarkersByType = (markers, type) => {\n  return markers.filter((marker) => {\n    const offerType = marker.offer.type;\n    return type === 'any' || offerType === type;\n  });\n};\n\nconst filterMarkersByPrice = (markers, price) => {\n  return markers.filter((marker) => {\n    const offerPrice = marker.offer.price;\n    switch (price) {\n      case 'low':\n        return offerPrice < 10000;\n      case 'middle':\n        return offerPrice >= 10000 && offerPrice <= 50000;\n      case 'high':\n        return offerPrice > 50000;\n      default:\n        return true;\n    }\n  });\n};\n\nconst filterMarkersByRooms = (markers, selectedRooms) => {\n  if (selectedRooms === 'any') {\n    return markers;\n  }\n  return markers.filter((marker) => marker.offer.rooms === parseInt(selectedRooms, 10));\n};\n\nconst filterMarkersByGuests = (markers, selectedGuests) => {\n  if (selectedGuests === 'any') {\n    return markers;\n  }\n  return markers.filter((marker) => marker.offer.guests === parseInt(selectedGuests, 10));\n};\n\nconst filterMarkersByFeatures = (markers, selectedFeatures) => {\n  return markers.filter((marker) => {\n    // Проверяем, есть ли выбранные features в массиве features маркера\n    return selectedFeatures.every((feature) => marker.offer.features.includes(feature));\n  });\n};\n\nexport { filterMarkersByType, filterMarkersByPrice, filterMarkersByRooms, filterMarkersByGuests, filterMarkersByFeatures };\n","import { initializeMap } from './map.js';\nimport { getData } from './fetch.js';\nimport { setFormSubmit } from './form.js';\n\ngetData((data) => {\n  initializeMap(data);\n});\n\nsetFormSubmit();\n"],"names":["min","max","Math","floor","random","from","to","decimalPlaces","randomFloat","_","multiplier","pow","round","generateRandomFloat","checkEsc","evt","key","errorTemplate","document","querySelector","content","errorFragment","createDocumentFragment","successTemplate","successFragment","removeAllerts","errorAlert","successAlert","remove","addEventListener","userTitleInput","valueLength","value","length","setCustomValidity","reportValidity","typeSelect","priceInput","handleTypeChange","placeholder","MAX_PRICE_VALUE","userPriceInput","parseInt","timeInSelectId","timeOutSelectId","timeInSelect","getElementById","timeOutSelect","boundTimeInChangeHandler","bind","this","boundTimeOutChangeHandler","synchronizeTimeFields","roomNumberSelect","capacitySelect","setCapacityOptions","selectedRoomNumber","querySelectorAll","forEach","option","disabled","disableOptions","selectElement","values","includes","synchronizeRoomsAndGuests","FILE_TYPES","fileChooser","previewContainer","preview","file","files","fileName","name","toLowerCase","some","it","endsWith","reader","FileReader","src","result","removeAttribute","style","padding","display","flexShrink","justifyContent","alignItems","overflow","maxHeight","readAsDataURL","fileChooserImages","previewImagesContainer","type","image","Image","maxWidth","clientWidth","clientHeight","width","height","ratio","backgroundImage","backgroundSize","backgroundRepeat","backgroundPosition","adForm","formElements","mapFiltersForm","mapFiltersElements","disableForm","classList","add","element","reset","resetMainPinMarker","cardTemplate","typeLabels","flat","bungalow","house","palace","mainPinMarker","data","map","addressInput","initializeMap","markers","L","setView","lat","lng","tileLayer","attribution","addTo","mainPinIcon","icon","iconUrl","iconSize","iconAnchor","mainPinLatLng","marker","draggable","initialLatLng","getLatLng","formattedInitialLatLng","formatCoordinates","on","latLng","target","formattedLatLng","housingTypeSelect","housingPriceSelect","housingRoomsSelect","housingGuestsSelect","housingFeaturesFieldset","filterMarkers","selectedType","selectedPrice","selectedRooms","selectedGuests","selectedFeatures","Array","input","filteredMarkers","filter","offerType","offer","filterMarkersByType","price","offerPrice","filterMarkersByPrice","rooms","filterMarkersByRooms","guests","filterMarkersByGuests","every","feature","features","filterMarkersByFeatures","updateMarkers","error","Error","setLatLng","toFixed","eachLayer","layer","Marker","removeLayer","slice","point","location","bindPopup","author","cardElement","cloneNode","textContent","title","typeLabel","checkin","checkout","featuresList","parentElement","innerHTML","featureItem","createElement","appendChild","description","photosList","photos","container","photoSrc","photoElement","alt","avatar","createCard","keepInView","fetch","then","response","json","showSuccess","showError","body","preventDefault","errorElement","errorButton","contains","FormData","method","ok","successElement","catch"],"sourceRoot":""}